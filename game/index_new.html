<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-5M9PGYFQNR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-5M9PGYFQNR');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrainRing</title>
    <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div id="topControls">
    <div style="display: flex; align-items: center; flex-wrap: wrap; gap: 10px;">
        <div id="timerDisplay" style="min-width: 100px; color: #d9534f; font-weight: bold;"></div>
        <button id="timer1Btn" onclick="startTimer(60)" aria-label="Start 1 minute timer">Start 1-Min</button>
        <button id="timer2Btn" onclick="startTimer(120)" aria-label="Start 2 minute timer">Start 2-Min</button>
        <button id="timer3Btn" onclick="startTimer(180)" aria-label="Start 3 minute timer">Start 3-Min</button>
        <button class="retryBtn" onclick="resetOutput()" aria-label="Reset game output">Retry</button>
    </div>
    <div id="questionSelector" class="selector">
        <label style="font-size: 30px;" for="questionValue">Question:</label>
        <button onclick="changeQuestion(-1)" aria-label="Previous question">
            <img src="icon/angle-left.svg" alt="Previous" width="20" height="20">
        </button>
        <span style="font-size: 35px;" id="questionValue" aria-live="polite">1</span>
        <button onclick="changeQuestion(1)" aria-label="Next question">
            <img src="icon/angle-right.svg" alt="Next" width="20" height="20">
        </button>
    </div>
    <div id="roundSelector" class="selector">
        <label style="font-size: 30px;" for="roundValue">Round:</label>
        <button onclick="changeRound(-1)" aria-label="Previous round">
            <img src="icon/angle-left.svg" alt="Previous" width="20" height="20">
        </button>
        <span style="font-size: 35px;" id="roundValue" aria-live="polite">2</span>
        <button onclick="changeRound(1)" aria-label="Next round">
            <img src="icon/angle-right.svg" alt="Next" width="20" height="20">
        </button>
    </div>

    <button class="retryBtn" onclick="retrySession()" aria-label="Retry entire session">Retry Session</button>
    <div style="position: relative;">
        <img id="muteIcon" src="icon/mute_17879746.png" alt="Mute audio" style="width: 25px; height: 25px; cursor: pointer;" onclick="toggleMute()" role="button" tabindex="0">
        <img id="settingsIcon" src="https://cdn-icons-png.flaticon.com/512/2099/2099058.png" alt="Settings"
             style="width: 25px; height: 25px; cursor: pointer; margin-left: 10px;" onclick="toggleSettingsMenu()" role="button" tabindex="0">

        <div id="settingsMenu" role="menu" aria-label="Team settings">
            <div class="team-setting" data-team="red">
                <input type="checkbox" data-team="red" checked id="team-red-checkbox" aria-label="Show/hide Red team">
                <span class="team-label">Red</span>
                <button class="edit-btn" onclick="editTeamName('red')" aria-label="Edit Red team name">
                    <img style="width:15px; height: 15px" src="icon/pencil.svg" alt="Edit">
                </button>
            </div>
            <div class="team-setting" data-team="green">
                <input type="checkbox" data-team="green" checked id="team-green-checkbox" aria-label="Show/hide Green team">
                <span class="team-label">Green</span>
                <button class="edit-btn" onclick="editTeamName('green')" aria-label="Edit Green team name">
                    <img style="width:15px; height: 15px" src="icon/pencil.svg" alt="Edit">
                </button>
            </div>
            <div class="team-setting" data-team="blue">
                <input type="checkbox" data-team="blue" checked id="team-blue-checkbox" aria-label="Show/hide Blue team">
                <span class="team-label">Blue</span>
                <button class="edit-btn" onclick="editTeamName('blue')" aria-label="Edit Blue team name">
                    <img style="width:15px; height: 15px" src="icon/pencil.svg" alt="Edit">
                </button>
            </div>
            <div class="team-setting" data-team="white">
                <input type="checkbox" data-team="white" checked id="team-white-checkbox" aria-label="Show/hide White team">
                <span class="team-label">White</span>
                <button class="edit-btn" onclick="editTeamName('white')" aria-label="Edit White team name">
                    <img style="width:15px; height: 15px" src="icon/pencil.svg" alt="Edit">
                </button>
            </div>
            <div class="team-setting" data-team="yellow">
                <input type="checkbox" data-team="yellow" checked id="team-yellow-checkbox" aria-label="Show/hide Yellow team">
                <span class="team-label">Yellow</span>
                <button class="edit-btn" onclick="editTeamName('yellow')" aria-label="Edit Yellow team name">
                    <img style="width:15px; height: 15px" src="icon/pencil.svg" alt="Edit">
                </button>
            </div>
            <div class="team-setting" data-team="pink">
                <input type="checkbox" data-team="pink" checked id="team-pink-checkbox" aria-label="Show/hide Pink team">
                <span class="team-label">Pink</span>
                <button class="edit-btn" onclick="editTeamName('pink')" aria-label="Edit Pink team name">
                    <img style="width:15px; height: 15px" src="icon/pencil.svg" alt="Edit">
                </button>
            </div>

            <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">
        </div>
    </div>
</div>

<div id="mainContent">
    <div id="leftPanel">
        <div id="output" role="log" aria-live="polite" aria-label="Game output">
            <p>Let the battle begin!</p>
        </div>
        <div>
            <div id="element1" class="element">Green
                <button class="circle-button" id="addGreen1" aria-label="Add 1 point to Green team">+1</button>
                <button class="circle-button" id="addGreen2" aria-label="Add 2 points to Green team">+2</button>
                <button class="circle-button" id="addGreen3" aria-label="Add 3 points to Green team">+3</button>
            </div>
            <div id="element2" class="element">Red
                <button class="circle-button" id="addRed1" aria-label="Add 1 point to Red team">+1</button>
                <button class="circle-button" id="addRed2" aria-label="Add 2 points to Red team">+2</button>
                <button class="circle-button" id="addRed3" aria-label="Add 3 points to Red team">+3</button>
            </div>
            <div id="element3" class="element">Blue
                <button class="circle-button" id="addBlue1" aria-label="Add 1 point to Blue team">+1</button>
                <button class="circle-button" id="addBlue2" aria-label="Add 2 points to Blue team">+2</button>
                <button class="circle-button" id="addBlue3" aria-label="Add 3 points to Blue team">+3</button>
            </div>
            <div id="element4" class="element">White
                <button class="circle-button" id="addWhite1" aria-label="Add 1 point to White team">+1</button>
                <button class="circle-button" id="addWhite2" aria-label="Add 2 points to White team">+2</button>
                <button class="circle-button" id="addWhite3" aria-label="Add 3 points to White team">+3</button>
            </div>
            <div id="element5" class="element">Yellow
                <button class="circle-button" id="addYellow1" aria-label="Add 1 point to Yellow team">+1</button>
                <button class="circle-button" id="addYellow2" aria-label="Add 2 points to Yellow team">+2</button>
                <button class="circle-button" id="addYellow3" aria-label="Add 3 points to Yellow team">+3</button>
            </div>
            <div id="element6" class="element">Pink
                <button class="circle-button" id="addPink1" aria-label="Add 1 point to Pink team">+1</button>
                <button class="circle-button" id="addPink2" aria-label="Add 2 points to Pink team">+2</button>
                <button class="circle-button" id="addPink3" aria-label="Add 3 points to Pink team">+3</button>
            </div>
        </div>
        <div id="question" class="container">
            <div id="questionDisplay" class="content" style="margin-top: 10px;">
                <div class="question-meta">
                    <div><strong>Question Number:</strong> <span id="qNumber" aria-live="polite">-</span></div>
                    <div class="answer-container">
                        <strong>Answer:</strong>
                        <span id="qAnswer" class="masked" onclick="toggleAnswerVisibility()" role="button" tabindex="0" aria-label="Click to reveal answer"></span>
                        <button id="toggleAnswerBtn" onclick="toggleAnswerVisibility()" aria-label="Toggle Answer">
                            üëÅÔ∏è
                        </button>
                    </div>
                </div>
                <p><strong>Question:</strong> <span id="qText" aria-live="polite">No question loaded</span></p>
            </div>
            <div class="button-wrapper">
                <input type="file" id="csvUpload" accept=".csv" hidden aria-label="Upload CSV file with questions">
                <label for="csvUpload" class="btn btn-gray btn-small">Upload CSV</label>
                <button class="btn btn-green btn-small" onclick="loadCSV()" aria-label="Load questions from uploaded CSV">Load Questions</button>
                <button class="btn btn-red btn-small" onclick="clearCSV()" aria-label="Clear all loaded questions">Clear Questions</button>
                <button class="btn btn-gray btn-small" onclick="prevQuestion()" aria-label="Previous question">
                    <img src="icon/angle-left.svg" alt="Previous" width="20" height="15">
                </button>
                <button class="btn btn-gray btn-small" onclick="nextQuestion()" aria-label="Next question">
                    <img src="icon/angle-right.svg" alt="Next" width="20" height="15">
                </button>
            </div>
        </div>
    </div>
    <div id="tableContainer">
        <div class="total" id="teamTotal" role="region" aria-label="Team scores">
            <div style="border: 3px solid red; background: #FA8072">
                <span class="team-name">Red Team</span>
                <span class="team-points" id="points-red" aria-live="polite">0</span>
            </div>
            <div style="border: 3px solid green; background: #90EE90">
                <span class="team-name">Green team</span>
                <span class="team-points" id="points-green" aria-live="polite">0</span>
            </div>
            <div style="border: 3px solid blue; background: #D6EEFF">
                <span class="team-name">Blue team</span>
                <span class="team-points" id="points-blue" aria-live="polite">0</span>
            </div>
            <div style="border: 3px solid #CCCCCC; background: #F5F5F5">
                <span class="team-name">White team</span>
                <span class="team-points" id="points-white" aria-live="polite">0</span>
            </div>
            <div style="border: 3px solid #DAA520; background: #FFFACD">
                <span class="team-name">Yellow team</span>
                <span class="team-points" id="points-yellow" aria-live="polite">0</span>
            </div>
            <div style="border: 3px solid pink; background: #FFE4E1">
                <span class="team-name">Pink Team</span>
                <span class="team-points" id="points-pink" aria-live="polite">0</span>
            </div>
        </div>
        <div class="tabs" role="tablist" aria-label="Game rounds">
            <div class="tab active" data-tab="tab1" role="tab" aria-selected="true" aria-controls="tab1">Yes / No round</div>
            <div class="tab" data-tab="tab2" role="tab" aria-selected="false" aria-controls="tab2">Simple questions round</div>
            <div class="tab" data-tab="tab3" role="tab" aria-selected="false" aria-controls="tab3">Hard question round</div>
            <div class="tab" data-tab="tab4" role="tab" aria-selected="false" aria-controls="tab4">Captains round</div>
            <div class="tab" data-tab="tab5" role="tab" aria-selected="false" aria-controls="tab5">Statistics</div>
        </div>

        <div class="tab-content active" id="tab1" role="tabpanel" aria-labelledby="tab1">
            <h2>Yes/No</h2>
            <table id="tableYesNo" role="table" aria-label="Yes/No round scores">
                <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col" class="team-red">Red</th>
                    <th scope="col" class="team-green">Green</th>
                    <th scope="col" class="team-blue">Blue</th>
                    <th scope="col" class="team-white">White</th>
                    <th scope="col" class="team-yellow">Yellow</th>
                    <th scope="col" class="team-pink">Pink</th>
                </tr>
                </thead>
            </table>
        </div>

        <div class="tab-content" id="tab2" role="tabpanel" aria-labelledby="tab2">
            <h2>Simple questions</h2>
            <table id="tableSimple" role="table" aria-label="Simple questions round scores">
                <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col" class="team-red">Red</th>
                    <th scope="col" class="team-green">Green</th>
                    <th scope="col" class="team-blue">Blue</th>
                    <th scope="col" class="team-white">White</th>
                    <th scope="col" class="team-yellow">Yellow</th>
                    <th scope="col" class="team-pink">Pink</th>
                </tr>
                </thead>
            </table>
        </div>

        <div class="tab-content" id="tab3" role="tabpanel" aria-labelledby="tab3">
            <h2>Hard Questions</h2>
            <table id="tableHard" role="table" aria-label="Hard questions round scores">
                <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col" class="team-red">Red</th>
                    <th scope="col" class="team-green">Green</th>
                    <th scope="col" class="team-blue">Blue</th>
                    <th scope="col" class="team-white">White</th>
                    <th scope="col" class="team-yellow">Yellow</th>
                    <th scope="col" class="team-pink">Pink</th>
                </tr>
                </thead>
            </table>
        </div>
        <div class="tab-content" id="tab4" role="tabpanel" aria-labelledby="tab4">
            <h2>Captain's round</h2>
            <table id="tableCap" role="table" aria-label="Captain's round scores">
                <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col" class="team-red">Red</th>
                    <th scope="col" class="team-green">Green</th>
                    <th scope="col" class="team-blue">Blue</th>
                    <th scope="col" class="team-white">White</th>
                    <th scope="col" class="team-yellow">Yellow</th>
                    <th scope="col" class="team-pink">Pink</th>
                </tr>
                </thead>
            </table>
        </div>
        <div class="tab-content" id="tab5" role="tabpanel" aria-labelledby="tab5">
            <h2>Statistics</h2>
            <div style="margin-bottom: 15px;">
                <button class="btn btn-green btn-small" onclick="exportStatistics()" aria-label="Export statistics to CSV">Export CSV</button>
                <button class="btn btn-red btn-small" onclick="resetStatistics()" aria-label="Clear statistics">Clear Stats</button>
            </div>
            <table id="statisticsTable" role="table" aria-label="Game statistics">
                <thead>
                <tr>
                    <th scope="col">Round name</th>
                    <th scope="col">Correct answers</th>
                    <th scope="col">Incorrect answers</th>
                    <th scope="col">Correct in %</th>
                </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Audio Elements -->
<audio id="soundG" src="audio/mixkit-car-horn-718.wav" preload="auto"></audio>
<audio id="soundR" src="audio/mixkit-cartoon-blow-impact-2654.wav" preload="auto"></audio>
<audio id="soundB" src="audio/mixkit-impact-of-a-blow-2150.wav" preload="auto"></audio>
<audio id="soundW" src="audio/mixkit-bonus-collect-award-1937.wav" preload="auto"></audio>
<audio id="soundY" src="audio/mixkit-fairy-arcade-sparkle-866.wav" preload="auto"></audio>
<audio id="soundP" src="audio/mixkit-retro-game-notification-212.wav" preload="auto"></audio>
<audio id="soundOff" src="audio/mixkit-sad-game-over-trombone).mp3" preload="auto"></audio>
<audio id="soundBackground1" src="audio/last10secondAudio.mp3" preload="auto"></audio>

<!-- Load JavaScript modules -->
<script src="core.js"></script>
<script src="game.js"></script>
<script src="tables.js"></script>
<script src="statistics.js"></script>

<script>
    // Initialize the application when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
        try {
            // Initialize core systems
            window.BrainRing.initializeApp();
            
            console.log('‚úÖ BrainRing application loaded successfully');
        } catch (error) {
            console.error('‚ùå Failed to load BrainRing application:', error);
        }
    });
</script>
</body>
</html>
